!function(n,t){var e,r=n.document,o=n.location,i=n.navigator,a=n.console,c=n.parseInt,u=n.setTimeout,f=n.encodeURIComponent,s=n.decodeURIComponent,p=n.localStorage,l=n.sessionStorage,d=n.String,g=n.Array,v=n.Object,h=n.Date,m=n.Function,_=n.Math,w=n.JSON,y=n.Image,k=n.XMLHttpRequest,b=n.FormData,C=n.unescape,S=n.Promise,I=n.CompressionStream,x=n.Response,B=n.Blob;function L(){return"prerender"===r.visibilityState}function T(n,t){var e,r=v.prototype.hasOwnProperty;for(e in n)r.call(n,e)&&t(e,n[e])}function O(n){return"object"==typeof n&&null!==n&&n.constructor===v}function U(n,e,r){return T(e,(function(e,o){r&&O(o)?(O(n[e])||(n[e]={}),U(n[e],o,r)):r&&o instanceof g?(n[e]instanceof g||(n[e]=[]),U(n[e],o,r)):o!==t&&(n[e]=o)})),n}function z(n,e){return T(e,(function(e,r){n[e]===t&&(n[e]=r)})),n}function A(n){n=n||{};var t,e,o,i,a={},c=r.cookie.split("; ");for(t=0;t<c.length;t++)c[t]&&(o=(e=c[t].split("=")).shift(),'"'===(i=e.join("="))[0]&&(i=i.slice(1,-1)),a[s(o)]=n.raw?i:s(i));return a}function H(n,t,e){var o=f(n)+"="+f(t);return(e=U({path:"/"},e)).expires&&(e.expires=e.expires.toUTCString()),T(e,(function(n){var t=e[n];t&&(o+="; "+n,!0!==t&&(o+="="+t))})),r.cookie=o,r.cookie}function j(n,t){H(n,"",t=U({expires:new h(h.now()-1)},t))}function P(n){return p?p.getItem(n):A()[n]}function R(n,t){p?p.setItem(n,t):H(n,t,{expire:new h(+new h+31536e7)})}function q(n){return p?null!==p.getItem(n):A()[n]}function M(n){p?p.removeItem(n):j(n)}function D(n,t){n=n.charCodeAt(0),t=t.charCodeAt(0);for(var e="",r=n;r<=t;r++)e+=d.fromCharCode(r);return e}function E(){return e||(e=D("0","9")+D("a","z")),function(n,t){for(var e="",r=0;r<32;r++)e+=n[_.floor(_.random()*n.length)];return e}(e)}function F(n){var e={};return T(n,(function(n,r){e[n]=function(n,e){if(e instanceof m)try{return e(n)}catch(r){return t}return e}(n,r)})),e}var J,G,N,X,K="_onetrack_cid",Q="_onetrack_uid",V="_onetrack_uid_type",W="_onetrack_sid",Y="_onetrack_st",Z="_onetrack_queue",$=[3e3,1e4,3e4],nn="beacon",tn={cn:"tracking.miui.com","in":"tracking.india.miui.com",ru:"tracking.rus.miui.com",auto:"auto.tracking.miui.com",_:"tracking.intl.miui.com"};function en(n){var t="string"==typeof n,e=N||(N=function(){for(var n=[],t=0;t<256;t++){for(var e=t,r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;n[t]=e}return n}()),r=-1;t&&(n=C(f(n)));for(var o=0;o<n.length;o++)r=r>>>8^e[255&(r^(t?n.charCodeAt(o):n[o]))];return((-1^r)>>>0).toString(16)}function rn(n){var t=n.url,e=n.fail,r=n.data,o=n.success;"beacon"===nn&&i.sendBeacon?i.sendBeacon(t,r)?o():e():function(n,t){var e=new k,r=t.data,o=t.fail,i=t.success;e.open(t.method,n,!0),e.onreadystatechange=function(){if(4===e.readyState){var n={};if(200===e.status)try{n=w.parse(e.responseText)}catch(t){}0===n.code?i():o()}},e.send(r)}(t,U(n,{data:r}))}function on(n,e){var r=new y,o={_:0+_.floor(2147483648*_.random())};T((e=e||{}).H,(function(n,t){o["H."+n]=t})),T(e.B,(function(n,t){o["B."+n]=t})),r.onload=r.onerror=function(){r.onload=null,r.onerror=null},o=function(n,e){var r,o="";return T(n,(function(n,e){if(e!=t)if(e instanceof g)for(r=0;r<e.length;r++)o+="&"+f(n)+"="+f(e[r]);else o+="&"+f(n)+"="+f(e)})),o.substr(1)}(o),r.src=n+"?"+o+"&sign="+en(o)}function an(){X=t;for(var n=0;n<1;n++)cn()}function cn(){var n=fn();if(n.length){var t=n.slice(0,20);sn(n.slice(20)),un(t,cn)}}function un(n,t,e){J&&function(n){var t=n.data,e=n.imgUrl,r=n.success;if(S){var o=w.stringify(t),i=new b;(function(n){var t="function"==typeof I;return new S((function(e,r){return t?new x(new B([n]).stream().pipeThrough(new I("gzip"))).arrayBuffer().then((function(n){e(n)})):r()}))})(o).then((function(t){i.append("p",new B([t]),"p"),i.append("gzip",1),i.append("sign",en(new Uint8Array(t))),rn(U(n,{data:i}))}),(function(){i.append("p",new B([o]),"p"),i.append("sign",en(o)),rn(U(n,{data:i}))}))}else if(b){var a=w.stringify(t),c=new b;c.append("p",new B([a]),"p"),c.append("sign",en(a)),rn(U(n,{data:c}))}else for(var u=0;u<t.length;u++)on(e,t[u]),r()}({url:J,imgUrl:G,method:"POST",data:n,success:t,fail:function(){!function(n,t,e){var r=$[$.indexOf(e)+1];r?u((function(){un(n,t,r)}),r):sn(fn().concat(n))}(n,t,e)}})}function fn(){var n;try{n=w.parse(P(Z)||"[]")}catch(t){n=[]}return n}function sn(n){R(Z,w.stringify(n||[]))}var pn,ln,dn={},gn={},vn=[],hn=!1,mn=!1;function _n(){if(hn&&mn){var n,e;U(dn,{instance_id:(o=P(K),o||(o=function(){var n,t=A()._onetrack;return t&&(n=t.slice(3),j("_onetrack")),n}()||E(),R(K,o)),o),session_id:Sn,uid:function(){return P(Q)||t},uid_type:function(){return P(V)||t},sdk_ver:"1.0.0",e_ts:function(){return+new h},tz:(n=(new h).getTimezoneOffset(),e=_.abs(n),"GMT"+(n>0?"-":"+")+("00"+_.floor(e/60)).slice(-2)+":"+("00"+e%60).slice(-2)),ot_test_env:P("_onetrack_test")?1:t}),U(dn,pn),U(gn,{first_open:q(K)?0:1}),U(gn,ln);for(var r=0;r<vn.length;r++)try{vn[r][0].apply(t,vn[r][1])}catch(i){}vn.length=0}var o}var wn=!1;function yn(){var n,t;wn=!0,hn=!0,_n(),function(){for(var n=[],t=fn(),e=0;e<t.lenth;e++){var r=t[e].H.e_ts;h.now()-r<864e5&&n.push(t[e])}sn(n)}(),n={platform:"JS"},t={referrer:r.referrer,location:function(){return o.href},page:function(){return o.pathname},title:function(){return r.title},encoding:r.characterSet||r.charset,language:(i.language||i.browserLanguage||"").toLowerCase(),screen_width:screen&&screen.width,screen_height:screen&&screen.height},pn=n,ln=t,mn=!0,_n()}function kn(n){return function(){try{var e=arguments;wn||yn(),hn&&mn?n.apply(t,e):vn.push([n,e])}catch(r){}}}function bn(n,e){if(n&&dn.app_id){O(e)||(e={});var r,o={event:n};z(o,dn),z(e,gn),r={H:F(o),B:F(e)},sn(fn().concat(r)),X===t&&(X=u(an,0)),q("_onetrack_debug")&&a.log("onetrack",r)}}function Cn(n,e){n!=t?R(Q,n):M(Q),e!=t?R(V,e):M(V)}function Sn(){var n,t=+new h,e=(n=W,l?l.getItem(n):A()[n]),r=c(P(Y),10);return(!e||!r||r<t-18e5)&&(e=E(),function(n,t){l?l.setItem(n,t):H(n,t)}(W,e)),R(Y,t),e}var In,xn={init:kn((function(n,e,r,o,i){var a,c,u;O(e)&&(r=e.region,o=e.instanceId,i=e.transport,e=e.channel),O(o)&&(o="cookie"===o.type&&o.name?(a=o.name,c=o.options,(u=A()[a])||H(a,u=E(),U({expires:new h(+new h+31536e7)},c)),u):t),function(n){nn="xhr"===n?"xhr":"beacon"}(i),U(dn,{app_id:n,channel:e||"default",instance_id:o||t,region:r}),function(n){var t=tn.cn;n&&n.toLowerCase&&(n=n.toLowerCase(),t=tn[n]||tn._),J=(G="https://"+t+"/track/v4/js")+"_a"}(r),bn("onetrack_dau")})),set:kn((function(n,t){O(n)?U(gn,n):gn[n]=t})),track:kn(bn),trackPage:kn((function(n){bn("view",n)})),login:kn((function(n,t,e,r){Cn(n,t),r||bn("ot_login",e)})),logout:kn((function(n){bn("ot_logout",n),Cn(t,t)}))};function Bn(n){try{var e=g.prototype.slice.call(arguments,1);xn[n].apply(t,e)}catch(r){}}In=function(){var e,r=n.onetrack;if(n.onetrack=Bn,(r=r&&r.q)instanceof g)for(e=0;e<r.length;e++)Bn.apply(t,r[e])},L()?r.addEventListener("visibilitychange",(function Ln(){L()||(r.removeEventListener("visibilitychange",Ln),In())})):In()}(window);
